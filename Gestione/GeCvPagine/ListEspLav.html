<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Esperienze Lavorative</title>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script>
        var uri = '../api/CV/EEEE/EspLav';
        $(document).ready(function () {
            ListEspLav();
        });
        function ListEspLav() {
            $('#ListEspLav').show();
            $('#AddE').hide();
            $('#ListEspLav').empty();
            $.getJSON(uri)
                .done(function (data) {
                    $.each(data, function (key, item) {
                        '<div class="container">'
                        $('#ListEspLav').append('<div class="row"><div class="col-md-6">' + item.Qualifica + '</div><div class="col-md-3"><button class="btn btn-default" onclick="LoadEspLav(' + item.Id + ')"role=button>Dettagli</button></div></div>');
                        '</div>';
                    });
                });
        }
        function LoadEspLav(idEspLav) {
            $("#AddE").hide();
            $.getJSON(uri + '/' + idEspLav)
                .done(function (data) {
                    $('#DettEsp').html(
                        '<div class="container">' +
                        '<div class="row">' +
                        '<div class="col-md-3">Inizio</div>' +
                        '<div class="col-md-3"><input type="number" id="ai" class="form-control" name="_inizio" value="' + data.AnnoInizio + '" /></div>' +
                        '<div class="col-md-3">Fine</div>' +
                        '<div class="col-md-3"><input type="number" id="af" class="form-control" name="_fine" value="' + data.AnnoFine + '" /></div></div>' +
                        '<div class="row">' +
                        '<div class="col-md-3">Qualifica</div>' +
                        '<div class="col-md-3"><input type="text" id="qua" class="form-control" name="_qualifica" value="' + data.Qualifica + '" /></div>' +
                        '<div class="col-md-3">Descrizione</div>' +
                        '<div class="col-md-3"><input type="text" id="desc" class="form-control" name="_desricione" value="' + data.Descrizione + '" /></div></div></div>' +
                        '<button class="btn btn-default" onclick="DelEsp(' + data.Id + ')"role=button>Elimina</button>' + '</div>' + '<div>' +
                        '<button class="btn btn-default" onclick="ModEsp(' + data.Id + ')"role=button>Modifica</button>' + '</div>' + '<div>'
                    );
                    ListEspLav();
                });
        }

        function DelEsp(id) {
            $.ajax({
                url: '../api/CV/EEEE/EspLav/' + id,
                type: 'DELETE',
                success: function (result) {
                    $('#DettEsp').hide(),
                    ListEspLav()
                },
            });
        }
        function AddEsp() {
            $('#ListEspLav').hide();
            $('#DettEsp').hide();
            $('#AddEsp').html(
                '<div class="container" id="AddE">' +
                '<div class="row">' +
                '<div class="col-md-3">Inizio</div>' +
                '<div class="col-md-3"><input type="number" id="addAi" class="form-control" name="_inizio" placeholder="Data Inizio" /></div>' +
                '<div class="col-md-3">Fine</div>' +
                '<div class="col-md-3"><input type="number" id="addAf" class="form-control" name="_fine" placeholder="Data Fine" /></div></div>' +
                '<div class="row">' +
                '<div class="col-md-3">Qualifica</div>' +
                '<div class="col-md-3"><input type="text" id="addQua" class="form-control" name="_qualifica" placeholder="Qualifica" /></div>' +
                '<div class="col-md-3">Descrizione</div>' +
                '<div class="col-md-3"><input type="text" id="addDesc" class="form-control" name="_desricione" placeholder="Descrizione" /></div></div></div>' +
                '<button class="btn btn-default" onclick="AddEspLav()" role=button>Aggiungi</button>' + '</div>' + '<div>'+
                '<button class="btn btn-default" onclick="Lista()" role=button>Indietro</button>' + '</div>' + '<div>'
            );
        }
        function Lista() {
            $('#ListEspLav').show();
            $('#AddE').hide();
            $('#DettEsp').hide();
        }
        function AddEspLav() {
            var esp = {};
            esp.AnnoInizio = $("#addAi").val();
            esp.AnnoFine = $('#addAf').val();
            esp.Qualifica = $('#addQua').val();
            esp.Descrizione = $('#addDesc').val();
            $.ajax({
                data: esp,
                dataType: "application/json",
                url: '../api/CV/EEEE/EspLav',
                type: 'POST',
                success: function (result) {
                    $('#AddE').hide(),
                    $('#ListEspLav').show(),
                    ListEspLav()
                },
            });

        }
        function ModEsp(id) {
            var esp = {};
            esp.AnnoInizio = $("#ai").val();
            esp.AnnoFine = $('#af').val();
            esp.Qualifica = $('#qua').val();
            esp.Descrizione = $('#desc').val();
            $.ajax({
                data: esp,
                dataType: "application/json",
                url: '../api/CV/EEEE/EspLav/' + id,
                type: 'PUT',
                success: function (result) {
                    $('#DettEsp').hide(),
                        ListEspLav()
                },
            });
        }

    </script>
    <title>Esperienze Lavorative</title>
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1>Esperienze Lavorative</h1>
        </div>
        <div>
            <ul class="nav nav-tabs">
                <li id="ListEspLav" role="presentation" class="active"><a onclick="ListEspLav()">Esperienze</a></li>
                <li id="AddEsp" role="presentation" class="active"><a onclick="AddEsp() ">Aggiungi</a></li>
            </ul>
        </div>
        <!--<button class="btn btn-default" onclick="AddEsp()">Aggiungi</button>
    <div id="AddEsp"></div>
    <hr />
    <div id="ListEspLav"></div>-->
        <hr />
        <div id="DettEsp"></div>
    </div>
</body>
</html>