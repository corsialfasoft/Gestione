@using System;
@using Interfaces;
@using DAO;
@using Gestione.Controllers;

@{
    ViewBag.Title = "Dettaglio del Mese";
}

<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    td {
        border: 1px solid #dddddd;
        text-align: center;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dddddd;
    }

    input {
    }
</style>

<h2>@ViewBag.Title</h2>
<br />
<div>
    @if(ViewBag.Message != null) {
        <h3 class="alert alert-warning">@ViewBag.Message</h3>
    }
    <h4>Inserire l'anno di cui si vogliono visualizzare i dettagli</h4>
</div>
<div>
    <form action="/Home/VisualizzaMese" method="post">
        <select name="anno" required>
            @for(int a =2000;a<=DateTime.Now.Year; a++){
                <option value="@a">
                    @a
                </option>
            }
        </select>
        <select name="mese" required>
            @for(int a =1;a<=12; a++){
                <option value="@a">
                    @a
                </option>
            }
        </select>
        <input type="submit" value="Visualizza" class="btn info" style="color:white; background-color: #2196F3; background: #0b7dda;" />
    </form>
</div>
@if(@ViewBag.Year != null){
    string[] lisMesi = { "Gennaio", "Febbraio","Marzo","Aprile","Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre" };
    <br>
    <div class="panel panel-default">
        <table>
            <tr>
                <td>@ViewBag.Year</td>
                @for(int index=0; index < lisMesi.Length; index++) { 
                    if(ViewBag.Month == index+1) {
                        <td>@lisMesi[index]</td>                   
                    } else {
                        <td>
                            <form action="/Home/VisualizzaMese" method="post">
                                <input type="hidden" name="anno" value="@ViewBag.Year" />
                                <input type="hidden" name="mese" value="@(index+1)" />
                                <input type="submit" value="@lisMesi[index]" class="btn info" style="color:white; background-color: #2196F3; background: #0b7dda;" />
                            </form>
                        </td>
                    }
                }
            </tr>
        </table>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">Dettagli del mese di:</div>
        @{ 
            int Nday = DateTime.DaysInMonth(ViewBag.Year, ViewBag.Month);
        }
        <table>
            <tr>
                <td></td>
                @for(int i =1; i<= Nday;i++) {
                    <td>@i</td>
                }
            </tr>
            <tr>
                <td>Ore Lavoro</td>
                @{ 
                    DateTime dateTime = new DateTime(ViewBag.Year, ViewBag.Month,1);
                    for(int i =0; i< Nday;i++) {
                        if(ViewBag.Mese.Contains(new DTGiornoDMese{data = dateTime.AddDays(i) })) {
                            int index = ViewBag.Mese.IndexOf(new DTGiornoDMese { data = dateTime.AddDays(i) });
                            <td>@ViewBag.Mese[index].TotOreLavorate</td>
                        } else { 
                            <td/>
                        }
                    }
                }
            </tr>
                <tr>
                    <td>Ore Permesso</td>
                @{ 
                    dateTime = new DateTime(ViewBag.Year, ViewBag.Month,1);
                    for(int i =0; i< Nday;i++) {
                        if(ViewBag.Mese.Contains(new DTGiornoDMese{data = dateTime.AddDays(i) })) {
                            int index = ViewBag.Mese.IndexOf(new DTGiornoDMese { data = dateTime.AddDays(i) });
                            <td>@ViewBag.Mese[index].OrePermesso</td>
                        } else { 
                            <td/>
                        }
                    }
                }
            </tr>
            <tr>
                <td>Ore Ferie</td>
                @{ 
                    dateTime = new DateTime(ViewBag.Year, ViewBag.Month, 1);
                    for(int i =0; i< Nday;i++) {
                        if(ViewBag.Mese.Contains(new DTGiornoDMese{data = dateTime.AddDays(i) })) {
                            int index = ViewBag.Mese.IndexOf(new DTGiornoDMese { data = dateTime.AddDays(i) });
                            <td>@ViewBag.Mese[index].OreFerie</td>
                        } else { 
                            <td/>
                        }
                    }
                }
            </tr>
                <tr>
                    <td>Ore Malattia</td>
                @{ 
                    dateTime = new DateTime(ViewBag.Year, ViewBag.Month,1);
                    for(int i =0; i< Nday;i++) {
                        if(ViewBag.Mese.Contains(new DTGiornoDMese{data = dateTime.AddDays(i) })) {
                            int index = ViewBag.Mese.IndexOf(new DTGiornoDMese { data = dateTime.AddDays(i) });
                            <td>@ViewBag.Mese[index].OreMalattia</td>
                        } else { 
                            <td/>
                        }
                    }
                }
            </tr>
        </table>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                TotOre
            </div>
            <div class="col-md-3">

            </div>
            <div class="col-md-3">

            </div>
            <div class="col-md-3">

            </div>
        </div>
    </div>
}
