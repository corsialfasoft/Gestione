<!DOCTYPE html>

<html lang="it en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <!-- BOOSTRAP DEPENDENCIES BY http://getbootstrap.com/docs/3.3/getting-started/ -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td {
            border: 1px solid #dddddd;
            text-align: center;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }

        input {
        }
    </style>

    <script>
        var uri = '../api/Getime';
        $(document).ready(function () {
            $('#Message').hide();
            LoadGiorno(data);
            $("#Aggiungi").submit(function (event) {
                event.preventDefault();
                var $form = $(this)
                var giorno = {};
                var url = $form.attr("action");
                giorno.data = $form.find("input[name='_data']").val();
                var posting = $.post(url, giorno);
                posting.done(function (data) {
                    LoadGiorno(data);
                    $('#Message').show();
                    $("#Message").empty().append("Dettagli del giorno" + {data});
                    $('#DATA').val("");
                });
            });
        });
        function LoadGiorno(data) {
            $('#Message').hide();
            $("#DettaglioGiorno").show();
            $.getJSON(uri + '/' + data)
                .done(function (data) {
                    $("#DettaglioGiorno").html(
                        '<div class="panel panel-primary">' +
                        '<table class="table">' +
                        '<div class="col-md-1"><b> ID </b></div>' +
                        '<div class="col-md-4"><b> Descrizione </b></div>' +
                        '<div class="col-md-4"><b> Giacenza </b></div>' +
                        '<div class="col-md-2"><b></b></div>' +
                        '</table>' +
                        '<table class="table">' +
                        '<div class="col-md-1" style="margin-top:10px; margin-bottom:10px">' + data.Id + '</div>' +
                        '<div class="col-md-4" style="margin-top:10px; margin-bottom:10px">' + data.Descrizione + '</div>' +
                        '<div class="col-md-4" style="margin-top:10px; margin-bottom:10px">' + data.Giacenza + '</div>' +
                        '<a class="btn btn-primary col-md-2" style="margin-bottom:10px" onclick="Delete(' + id + ')" role="button">Elimina</a>' +
                        '</table>' +
                        '</div>'
                    );
                });
        }
    </script>

</head>
<body>
    <div class="container">
        <div class="page-header">
            <h2>Visualizzazione Dettagli Giorno</h2>
            <br />
            <div>
                <h4>Selezionare la data di cui si vogliono visualizzare i dettagli</h4>
            </div>
            <div>
                <h3 class="alert alert-warning" id="Message"></h3>
            </div>
            <div>
                <form action="/Home/VisualizzaGiorno" method="post">
                    <input type="date" name="_data" id="DATA" required />
                    <input type="submit" value="Seleziona" class="btn info" style="color:white; background-color: #2196F3; background: #0b7dda;" />
                </form>
            </div>
            <br>

            <div class="panel panel-default">
                <div class="panel-heading">Dettagli del giorno ("dd-MM-yyyy")</div>
                <table>
                    <tr>
                        <td>Tipo</td>
                        <td>Totale ore</td>
                        <td>Commessa</td>
                        <td>Ore lavoro commessa</td>
                        <td>Note</td>
                    </tr>
                    @foreach(OreLavorate orelavorate in ViewBag.giorno.OreLavorate) {
                    <tr>
                        @if (count == 0) {
                        <td>Totale ore lavoro</td>
                        <td>@ViewBag.giorno.TotOreLavorate</td>
                        count++;
                        } else {
                        <td></td>
                        <td></td>
                        }
                        <td>@orelavorate.nome</td>
                        <td>@orelavorate.oreGiorno</td>
                        <td>@orelavorate.descrizione</td>
                    </tr>
                    }
                    <tr>
                        <td>Totale ore permesso</td>
                        <td>@ViewBag.giorno.OrePermesso</td>
                    </tr>
                    <tr>
                        <td>Totale ore malattia</td>
                        <td>@ViewBag.giorno.OreMalattia</td>
                    </tr>
                    <tr>
                        <td>Totale ore ferie</td>
                        <td>@ViewBag.giorno.OreFerie</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</body>
</html>